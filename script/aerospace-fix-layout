#!/bin/bash
#
# AeroSpace Layout Restoration Script
# =====================================
#
# Purpose:
#   Restore workspace layouts after reconnecting displays to fix layout disruptions.
#
# Usage:
#   aerospace-fix-layout
#
#   Or if alias is configured in ~/.zshrc:
#   aerospace-fix
#
# What it does:
#   1. Reloads AeroSpace configuration (~/.aerospace.toml)
#   2. Fixes workspace A layout (Slack + Spark Desktop in vertical tiles)
#   3. Fixes workspace 11 layout (Cursor windows in horizontal tiles)
#
# When to use:
#   - After connecting/disconnecting external displays
#   - When workspace layouts become disorganized
#   - After AeroSpace crashes or restarts
#
# Prerequisites:
#   - AeroSpace v0.20.0+ must be installed
#   - ~/.aerospace.toml must be configured with workspace-to-monitor-force-assignment
#
# Configuration:
#   Add to ~/.zshrc for quick access:
#   alias aerospace-fix='/Users/keito4/develop/github.com/keito4/config/script/aerospace-fix-layout'
#
# Troubleshooting:
#   - If layouts still don't fix, manually use: Alt+Shift+; then press 'r'
#   - Check AeroSpace is running: aerospace --version
#   - Verify config is valid: aerospace reload-config
#
# Author: Created via Claude Code
# Last Updated: 2025-12-30
#

echo "ðŸ”§ Restoring AeroSpace layouts..."

# Reload configuration
echo "  â†’ Reloading config..."
aerospace reload-config

# Wait a moment for reload to complete
sleep 0.5

# Fix workspace A (Slack + Spark Desktop) - vertical layout
echo "  â†’ Fixing workspace A (Slack + Spark)..."
aerospace flatten-workspace-tree --workspace A 2>/dev/null
aerospace layout v_tiles --workspace A 2>/dev/null

# Fix workspace 11 (Cursor) - horizontal layout
echo "  â†’ Fixing workspace 11 (Cursor)..."
aerospace flatten-workspace-tree --workspace 11 2>/dev/null
aerospace layout h_tiles --workspace 11 2>/dev/null

echo "âœ… Layout restoration complete!"
echo ""
echo "Workspace A: Slack + Spark Desktop (vertical)"
echo "Workspace 11: Cursor windows (horizontal)"
